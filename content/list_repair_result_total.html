            <h2 style="color: blue">รายการสรุปผลการซ่อมครุภัณฑ์คอมพิวเตอร์</h2>
            <ol class="breadcrumb">
              <li><a href="index.html"><i class="หน้าหลัก"></i> หน้าหลัก</a></li>
              <li class="active"><i class="fa fa-wrench"></i> รายการซ่อม</li>
            </ol>
             
<script language="Javascript" type="text/javascript">
    //var column1 = '{"รายการความเสี่ยงที่รอ RM man มาตรวจสอบ":["เลขที่","รายการ","เกิดขึ้นเมื่อ","ได้รับเมื่อ"]}';
    var column1 = ["ลำดับ","วันที่แจ้ง","เลขครุภัณฑ์","ความสำคัญ","วันที่รับใบซ่อม","ผู้ซ่อม","รายละเอียด"];
              var CTb = new createTableAjax();
              CTb.GetNewTableAjax('contentTB','JsonData/DT_LRRPC.php','JsonData/tempSendData.php',column1
              ,null,false,false,null,true,'detailModal',false,null,'เร่งด่วน',null,null,'ไม่เร่งด่วน','dbtb');
              
              CTb.GetNewTableAjax('contentTB2','JsonData/DT_LRRPF.php','JsonData/tempSendData.php',column1
              ,null,false,false,null,true,'detailModal',false,null,'เร่งด่วน',null,null,'ไม่เร่งด่วน','dbtb2');
</script>
<div class="row">
    <div class="col-md-12">
            <div class="box box-success box-solid">
                <div class="box-header with-border">
                    <h4 class="box-title"><i class="fa fa-star"></i> รายการผลการซ่อมครุภัณฑ์คอมพิวเตอร์(สำเร็จ) </h4>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div><!-- /.box-tools -->
                </div><!-- /.box-header -->
                <div class="box-body">
        <div id="contentTB" class="table-responsive"></div>
                </div>
            </div>
    </div>
    
    <div class="col-md-12">
            <div class="box box-danger box-solid">
                <div class="box-header with-border">
                    <h4 class="box-title"><i class="fa fa-star"></i> รายการผลการซ่อมครุภัณฑ์คอมพิวเตอร์(ไม่สำเร็จ) </h4>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div><!-- /.box-tools -->
                </div><!-- /.box-header -->
                <div class="box-body">
        <div id="contentTB2" class="table-responsive"></div>
                </div>
            </div>
    </div>
</div>
<!---------------------------- Modal ---------------------------->
<div class="modal" id="detailModal" role="dialog" aria-labelledby="exampleModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="receiveModalLabel">รับใบแจ้งซ่อม</h4>
      </div>
        <div class="modal-body">
          <span id="detail"></span>
      </div>
      <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">ปิด</button>
      </div>
    </div>
  </div>
</div>
<script language="Javascript" type="text/javascript">
    function detailModal () {
    $('#detailModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget)
  var recipient = button.data('whatever')
  var modal = $(this)
  modal.find('.modal-title').text('รายละเอียดใบแจ้งซ่อม : ลำดับที่ ' + recipient)
  
   $.getJSON('JsonData/synopsis_repair_Data.php',{data: recipient},function (data) {
        $('span#detail').empty().append("ผู้แจ้งซ่อม : "+data.inform+"  &nbsp;&nbsp;งาน : "+data.depName+"<br>"
                            +"เลขครุภัณฑ์ : "+data.pd_number+"  &nbsp;&nbsp;หมายเหตุ : "+data.note+"<br>"
                            +"อาการ : "+data.symptom+"<br>วันที่แจ้ง : "+data.repair_date+" &nbsp;&nbsp;<b style='color: red;'>"+data.vital+"</b><br><hr>"
                            +"วันที่รับใบแจ้ง : "+data.receive_date+"&nbsp;&nbsp;ผู้รับใบแจ้งซ่อม : "+data.receiver+"<br><hr>"
                            +"วันที่เริ่มซ่อม : "+data.strepair_date+"&nbsp;&nbsp;วันที่ซ่อมเสร็จ : "+data.enrepair_dare+"&nbsp;&nbsp;ผู้ซ่อม : "+data.repairer+"<br>"
                            +"สรุปสาเหตุการเสีย : "+data.symp_name+"&nbsp;&nbsp;เกิดจาก &nbsp;&nbsp;"+data.symmptom_name+"<br>"
                            +"รายละเอียดการซ่อม : "+data.repair_detail+"<br><span id='acc'></span><span id='send'></span>"
                            +"ผู้รับครื่อง : "+data.rece_pd+"<br>"
                            +"วันที่บันทึกการซ่อม : "+data.result_recdate+"&nbsp;&nbsp;ผู้บันทึก : "+data.result_recorder);
                    if(data.accessories==1){
                        $.getJSON('JsonData/detail_acc_part.php',{data: data.repair_id}, function (CD) {
                                    var option='อุปกรณ์ที่เปลี่ยน :<br>';
                                    var c=1;
                                    for (var key in CD) {
                                              option += c+". "+CD[key].accp_name+" : "+CD[key].acc_detail+" &nbsp;&nbsp;ราคา "+CD[key].acc_price+" บาท <br>";
                                              c++;
                                        }
                                        $("span#acc").empty().html(option);
                                });
                    }
                    if(data.send_repair==1){
                        $.getJSON('JsonData/send_repair_Data.php',{data: data.repair_id}, function (CD) {
                                    var option='ส่งซ่อมภายนอก :<br>';
                                        option += "ส่งร้าน "+CD.comp_name+"<br>วันที่ส่ง "+CD.send_date+" &nbsp;&nbsp;วันที่รับคืน "+CD.resend_date+"<br>";
                                        option += "รายละเอียดการซ่อม "+CD.repair_detail+"<br>ค่าซ่อม "+CD.send_price+" บาท<br>";
                                         $("span#send").empty().html(option);
                                });
                    }

    });
})
    }  
</script>
